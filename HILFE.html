<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš• Funk Taxi App - Hilfe & Dokumentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f9fafb;
            color: #1f2937;
        }
        
        /* HEADER */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header h1 {
            font-size: 24px;
            margin-bottom: 15px;
        }
        
        .search-container {
            position: relative;
            max-width: 600px;
        }
        
        #search-input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            font-size: 16px;
            border: none;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        #search-input:focus {
            outline: 3px solid #fbbf24;
        }
        
        .search-icon {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 20px;
        }
        
        /* LAYOUT */
        .container {
            display: grid;
            grid-template-columns: 350px 1fr;
            height: calc(100vh - 120px);
            max-width: 1600px;
            margin: 0 auto;
        }
        
        /* SIDEBAR (LINKS) */
        .sidebar {
            background: white;
            border-right: 1px solid #e5e7eb;
            overflow-y: auto;
            padding: 20px;
        }
        
        .category {
            margin-bottom: 25px;
        }
        
        .category-title {
            font-weight: 700;
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .help-item {
            padding: 12px 15px;
            background: #f9fafb;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 3px solid transparent;
        }
        
        .help-item:hover {
            background: #f3f4f6;
            border-left-color: #667eea;
            transform: translateX(3px);
        }
        
        .help-item.active {
            background: #eef2ff;
            border-left-color: #667eea;
            font-weight: 600;
        }
        
        .help-item-title {
            font-size: 14px;
            margin-bottom: 3px;
        }
        
        .help-item-meta {
            font-size: 11px;
            color: #9ca3af;
        }
        
        /* CONTENT (RECHTS) */
        .content {
            background: white;
            padding: 40px;
            overflow-y: auto;
        }
        
        .content h2 {
            font-size: 28px;
            margin-bottom: 10px;
            color: #1f2937;
        }
        
        .content h3 {
            font-size: 20px;
            margin-top: 30px;
            margin-bottom: 15px;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 8px;
        }
        
        .content p {
            line-height: 1.8;
            margin-bottom: 15px;
            color: #4b5563;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 12px;
            background: #dbeafe;
            color: #1e40af;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .screenshot {
            width: 100%;
            max-width: 800px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin: 20px 0;
            border: 1px solid #e5e7eb;
        }
        
        .step-list {
            background: #f9fafb;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .step {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .step:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .step-number {
            flex-shrink: 0;
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
        }
        
        .step-content h4 {
            margin-bottom: 5px;
            font-size: 16px;
        }
        
        .step-content p {
            margin: 0;
            font-size: 14px;
            color: #6b7280;
        }
        
        .code-block {
            background: #1f2937;
            color: #f9fafb;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
        }
        
        .info-box {
            background: #dbeafe;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .warning-box {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .error-box {
            background: #fee2e2;
            border-left: 4px solid #ef4444;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .function-ref {
            background: #f3f4f6;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }
        
        .function-ref strong {
            color: #667eea;
        }
        
        .tag {
            display: inline-block;
            padding: 3px 8px;
            background: #e0e7ff;
            color: #3730a3;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            margin-right: 5px;
            margin-bottom: 5px;
        }
        
        #no-results {
            display: none;
            text-align: center;
            padding: 60px 20px;
            color: #9ca3af;
        }
        
        #no-results .emoji {
            font-size: 64px;
            margin-bottom: 20px;
        }
        
        .welcome-screen {
            text-align: center;
            padding: 60px 20px;
            color: #6b7280;
        }
        
        .welcome-screen .emoji {
            font-size: 80px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                height: auto;
            }
            
            .sidebar {
                border-right: none;
                border-bottom: 1px solid #e5e7eb;
                max-height: 300px;
            }
        }
    </style>
</head>
<body>
    <!-- HEADER -->
    <div class="header">
        <h1>ğŸš• Funk Taxi App - Hilfe & Dokumentation</h1>
        <div class="search-container">
            <input type="text" id="search-input" placeholder="ğŸ” Suche nach Feature, Funktion oder Problem..." autocomplete="off">
            <span class="search-icon">ğŸ”</span>
        </div>
    </div>
    
    <!-- CONTAINER -->
    <div class="container">
        <!-- SIDEBAR (Links) -->
        <div class="sidebar" id="sidebar">
            <!-- Wird mit JavaScript gefÃ¼llt -->
        </div>
        
        <!-- CONTENT (Rechts) -->
        <div class="content" id="content">
            <div class="welcome-screen">
                <div class="emoji">ğŸ‘‹</div>
                <h2>Willkommen zur Hilfe!</h2>
                <p style="margin-top: 20px;">WÃ¤hle ein Thema links oder nutze die Suchfunktion oben.</p>
            </div>
        </div>
    </div>
    
    <script>
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // HILFE-DATENBANK
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        const helpDatabase = {
            // ğŸš• BUCHUNG
            'express-booking': {
                title: 'âš¡ Express-Buchung',
                category: 'ğŸš• Buchung',
                tags: ['karte', 'schnell', 'admin', 'visuell'],
                lines: '6078-6212',
                functions: ['initExpressBooking', 'handleExpressMapClick', 'executeExpressBooking'],
                content: `
                    <h2>âš¡ Express-Buchung</h2>
                    <span class="badge">Admin</span>
                    <span class="badge">Zeile 6078-6212</span>
                    
                    <h3>ğŸ¯ Was ist das?</h3>
                    <p>Die Express-Buchung ist eine <strong>visuelle Schnellbuchung</strong> fÃ¼r Admins. Statt Adressen einzutippen, kannst du direkt auf der Karte klicken!</p>
                    
                    <div class="info-box">
                        <strong>ğŸ’¡ Vorteil:</strong> Buchung in 30 Sekunden statt 3 Minuten!
                    </div>
                    
                    <h3>ğŸ“ So funktioniert's:</h3>
                    <div class="step-list">
                        <div class="step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h4>Admin-Panel Ã¶ffnen</h4>
                                <p>Einloggen als Admin â†’ Admin-Dashboard â†’ "âš¡ Express-Buchung"</p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h4>Abholort auf Karte klicken</h4>
                                <p>Karte Ã¶ffnet sich â†’ <strong>1. KLICK</strong> setzt grÃ¼ne Stecknadel ğŸ“ â†’ Adresse wird automatisch gefÃ¼llt!</p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <h4>Zielort auf Karte klicken</h4>
                                <p><strong>2. KLICK</strong> setzt rote Stecknadel ğŸ¯ â†’ Adresse automatisch gefÃ¼llt â†’ Route wird gezeichnet!</p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <h4>Preis wird automatisch berechnet</h4>
                                <p>OSRM berechnet Route â†’ Distanz & Dauer â†’ Preis erscheint in grÃ¼ner Box ğŸ’°</p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">5</div>
                            <div class="step-content">
                                <h4>Restliche Felder ausfÃ¼llen</h4>
                                <p>Datum/Zeit, Kunde, Personen, Zahlungsmethode</p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">6</div>
                            <div class="step-content">
                                <h4>Buchen!</h4>
                                <p>Button "ğŸš• JETZT BUCHEN" klicken â†’ Fertig! ğŸ‰</p>
                            </div>
                        </div>
                    </div>
                    
                    <h3>ğŸ”§ Wichtige Funktionen:</h3>
                    <div class="function-ref">
                        <strong>initExpressBooking()</strong> - Zeile 33148<br>
                        Erstellt die Karte (Leaflet) und setzt Event-Listener
                    </div>
                    <div class="function-ref">
                        <strong>handleExpressMapClick(e)</strong> - Zeile 33202<br>
                        Wird bei Karten-Klick aufgerufen â†’ reverseGeocode â†’ Marker setzen
                    </div>
                    <div class="function-ref">
                        <strong>calculateExpressRouteAndPrice()</strong> - Zeile 33341<br>
                        Berechnet Route (OSRM) und Preis automatisch
                    </div>
                    <div class="function-ref">
                        <strong>executeExpressBooking()</strong> - Zeile 33609<br>
                        Speichert Buchung in Firebase
                    </div>
                    
                    <h3>ğŸ’¡ Tipps & Tricks:</h3>
                    <div class="info-box">
                        <strong>Stecknadeln verschiebbar!</strong><br>
                        Du kannst die Stecknadeln nach dem Setzen noch verschieben â†’ Adresse wird automatisch aktualisiert!
                    </div>
                    
                    <div class="info-box">
                        <strong>Auch Tippen mÃ¶glich!</strong><br>
                        Du kannst alternativ auch Adressen eintippen â†’ Autocomplete schlÃ¤gt vor â†’ Klicken â†’ Marker wird gesetzt!
                    </div>
                    
                    <h3>âš ï¸ HÃ¤ufige Probleme:</h3>
                    <div class="error-box">
                        <strong>âŒ Karte lÃ¤dt nicht?</strong><br>
                        â†’ Browser-Cache leeren (Strg+Shift+R)<br>
                        â†’ Leaflet CSS/JS prÃ¼fen (sollte in index.html sein)<br>
                        â†’ Console Ã¶ffnen (F12) â†’ Fehler?
                    </div>
                    
                    <div class="error-box">
                        <strong>âŒ Klick funktioniert nicht?</strong><br>
                        â†’ Console Ã¶ffnen â†’ Fehler "reverseGeocode is not defined"?<br>
                        â†’ Version v5.90.166+ verwenden (reverseGeocode wurde hinzugefÃ¼gt!)
                    </div>
                    
                    <div class="error-box">
                        <strong>âŒ Adresse nicht gefunden?</strong><br>
                        â†’ Nominatim API kÃ¶nnte offline sein<br>
                        â†’ Rate-Limit erreicht? (1 Request/Sekunde)<br>
                        â†’ Koordinaten werden als Fallback angezeigt
                    </div>
                    
                    <h3>ğŸ”— Verwendete APIs:</h3>
                    <div class="code-block">
// Leaflet - Karte
https://unpkg.com/leaflet@1.9.4/dist/leaflet.js

// Nominatim - Geocoding (Adresse â†’ Koordinaten)
https://nominatim.openstreetmap.org/search

// Nominatim Reverse - Koordinaten â†’ Adresse
https://nominatim.openstreetmap.org/reverse

// OSRM - Routing (Route berechnen)
https://router.project-osrm.org/route/v1/driving/
                    </div>
                `
            },
            
            'taxi-booking': {
                title: 'ğŸš• Taxi buchen (Normal)',
                category: 'ğŸš• Buchung',
                tags: ['fahrgast', 'Ã¶ffentlich', 'buchung'],
                lines: '1701-2100',
                functions: ['handlePriceButton', 'calculatePriceAndShow', 'geocode', 'calculateRoute'],
                content: `
                    <h2>ğŸš• Taxi buchen (Normal)</h2>
                    <span class="badge">Ã–ffentlich</span>
                    <span class="badge">Zeile 1701-2100</span>
                    
                    <h3>ğŸ¯ Was ist das?</h3>
                    <p>Die <strong>Standard-Buchungsmaske</strong> fÃ¼r FahrgÃ¤ste. Ã–ffentlich zugÃ¤nglich, keine Anmeldung nÃ¶tig!</p>
                    
                    <h3>ğŸ“ So funktioniert's:</h3>
                    <div class="step-list">
                        <div class="step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h4>Abholort eingeben</h4>
                                <p>Adresse eintippen â†’ Autocomplete-VorschlÃ¤ge â†’ AuswÃ¤hlen</p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h4>Zielort eingeben</h4>
                                <p>Adresse eintippen â†’ Autocomplete-VorschlÃ¤ge â†’ AuswÃ¤hlen</p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <h4>Wann fahren?</h4>
                                <p>"âš¡ SOFORT" oder "ğŸ“… VORBESTELLEN" (Datum/Zeit wÃ¤hlen)</p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <h4>Preis berechnen</h4>
                                <p>Button "ğŸ’° Preis berechnen" â†’ Route wird gezeigt â†’ Preis erscheint</p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">5</div>
                            <div class="step-content">
                                <h4>Kontaktdaten eingeben</h4>
                                <p>Name, Telefon (wird gespeichert fÃ¼r nÃ¤chstes Mal!)</p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">6</div>
                            <div class="step-content">
                                <h4>Taxi buchen!</h4>
                                <p>Button "ğŸš• TAXI BUCHEN" â†’ BestÃ¤tigung â†’ Fertig! ğŸ‰</p>
                            </div>
                        </div>
                    </div>
                    
                    <h3>ğŸ”§ Wichtige Funktionen:</h3>
                    <div class="function-ref">
                        <strong>geocode(address)</strong> - Zeile 15426<br>
                        Wandelt Adresse in Koordinaten um (Nominatim API)
                    </div>
                    <div class="function-ref">
                        <strong>calculateRoute(from, to)</strong> - Zeile 15487<br>
                        Berechnet Route mit OSRM (Distanz, Dauer, Geometrie)
                    </div>
                    <div class="function-ref">
                        <strong>calculatePrice(distance, timestamp, settings)</strong> - Zeile 15600<br>
                        Berechnet Preis basierend auf Distanz, Zeit, Tarif
                    </div>
                    <div class="function-ref">
                        <strong>handlePriceButton()</strong> - Zeile 19870<br>
                        Handler fÃ¼r "Preis berechnen" Button
                    </div>
                    
                    <h3>ğŸ’¡ Features:</h3>
                    <div class="info-box">
                        <strong>ğŸ“ GPS-Button</strong><br>
                        Nutzt aktuelle Position als Abholort!
                    </div>
                    
                    <div class="info-box">
                        <strong>â­ Favoriten speichern</strong><br>
                        Stern-Button neben Adresse â†’ Ort wird als POI gespeichert!
                    </div>
                    
                    <div class="info-box">
                        <strong>ğŸŒŸ Stammkunden-Funktion</strong><br>
                        Nach 1. Buchung: Daten werden gespeichert â†’ NÃ¤chstes Mal automatisch vorausgefÃ¼llt!
                    </div>
                `
            },
            
            'driver-tracking': {
                title: 'ğŸš— Fahrer GPS-Tracking',
                category: 'ğŸš— Fahrer',
                tags: ['gps', 'tracking', 'fahrer', 'live'],
                lines: '2500-2800',
                functions: ['startGPSTracking', 'updateDriverLocation'],
                content: `
                    <h2>ğŸš— Fahrer GPS-Tracking</h2>
                    <span class="badge">Fahrer</span>
                    <span class="badge">Zeile 2500-2800</span>
                    
                    <h3>ğŸ¯ Was ist das?</h3>
                    <p>Live-GPS-Tracking fÃ¼r Fahrer. Position wird automatisch alle 5 Sekunden in Firebase gespeichert!</p>
                    
                    <h3>ğŸ“ So funktioniert's:</h3>
                    <div class="step-list">
                        <div class="step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h4>Als Fahrer einloggen</h4>
                                <p>Login â†’ Rolle: "driver" â†’ Fahrer-View Ã¶ffnet sich</p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h4>GPS-Erlaubnis geben</h4>
                                <p>Browser fragt nach Standort-Erlaubnis â†’ "Erlauben" klicken</p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <h4>Tracking startet automatisch</h4>
                                <p>Position wird alle 5 Sekunden aktualisiert â†’ In Firebase gespeichert</p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <h4>Auf Karte sichtbar</h4>
                                <p>Admin kann Position in "Fahrzeug-Ãœbersicht" sehen</p>
                            </div>
                        </div>
                    </div>
                    
                    <h3>ğŸ”§ Wichtige Funktionen:</h3>
                    <div class="function-ref">
                        <strong>startGPSTracking()</strong> - Zeile 25000<br>
                        Startet watchPosition â†’ sendet Updates an Firebase
                    </div>
                    <div class="function-ref">
                        <strong>updateDriverLocation(lat, lon)</strong> - Zeile 25100<br>
                        Speichert Position in /vehicles/{vehicleId}
                    </div>
                    
                    <h3>âš ï¸ Wichtig:</h3>
                    <div class="warning-box">
                        <strong>ğŸ“± App muss offen bleiben!</strong><br>
                        GPS-Tracking funktioniert nur wenn Browser-Tab aktiv ist. Bei Hintergrund-App: Tracking pausiert!
                    </div>
                    
                    <div class="error-box">
                        <strong>âŒ GPS funktioniert nicht?</strong><br>
                        1. Standort-Erlaubnis prÃ¼fen (Browser-Einstellungen)<br>
                        2. GPS am Handy aktiviert?<br>
                        3. Console Ã¶ffnen â†’ Fehler "User denied Geolocation"?
                    </div>
                `
            },
            
            'firebase-structure': {
                title: 'ğŸ’¾ Firebase Datenbank-Struktur',
                category: 'ğŸ”§ Technik',
                tags: ['firebase', 'datenbank', 'struktur', 'technisch'],
                lines: 'N/A',
                functions: ['db.ref'],
                content: `
                    <h2>ğŸ’¾ Firebase Datenbank-Struktur</h2>
                    <span class="badge">Technik</span>
                    
                    <h3>ğŸ—„ï¸ Datenbank-Struktur:</h3>
                    <div class="code-block">
funk-taxi-app-default-rtdb/
â”œâ”€â”€ /rides              - Alle Fahrten
â”‚   â”œâ”€â”€ {rideId}
â”‚   â”‚   â”œâ”€â”€ pickup: "Bahnhofstr. 12"
â”‚   â”‚   â”œâ”€â”€ destination: "Strandstr. 5"
â”‚   â”‚   â”œâ”€â”€ pickupTimestamp: 1704645600000
â”‚   â”‚   â”œâ”€â”€ status: "pending" | "assigned" | "completed"
â”‚   â”‚   â”œâ”€â”€ vehicleId: "taxi-001"
â”‚   â”‚   â”œâ”€â”€ customerId: "customer-123"
â”‚   â”‚   â”œâ”€â”€ price: 25.00
â”‚   â”‚   â””â”€â”€ distance: 8.5
â”‚
â”œâ”€â”€ /vehicles           - Fahrzeuge (Live-GPS)
â”‚   â”œâ”€â”€ {vehicleId}
â”‚   â”‚   â”œâ”€â”€ name: "Taxi 1"
â”‚   â”‚   â”œâ”€â”€ status: "free" | "busy"
â”‚   â”‚   â”œâ”€â”€ lat: 53.9547
â”‚   â”‚   â”œâ”€â”€ lon: 14.1783
â”‚   â”‚   â”œâ”€â”€ lastUpdate: 1704645600000
â”‚   â”‚   â””â”€â”€ currentRideId: "ride-xyz" (optional)
â”‚
â”œâ”€â”€ /users              - Benutzer
â”‚   â”œâ”€â”€ {userId}
â”‚   â”‚   â”œâ”€â”€ name: "Max Mustermann"
â”‚   â”‚   â”œâ”€â”€ email: "max@example.com"
â”‚   â”‚   â”œâ”€â”€ role: "passenger" | "driver" | "admin"
â”‚   â”‚   â””â”€â”€ phone: "+49170123456"
â”‚
â”œâ”€â”€ /customers          - CRM-Kunden
â”‚   â”œâ”€â”€ {customerId}
â”‚   â”‚   â”œâ”€â”€ name: "Hotel Villa Monique"
â”‚   â”‚   â”œâ”€â”€ phone: "+49170123456"
â”‚   â”‚   â”œâ”€â”€ email: "kontakt@villa-monique.de"
â”‚   â”‚   â”œâ”€â”€ address: "Strandpromenade 1"
â”‚   â”‚   â”œâ”€â”€ notes: "Rechnung per E-Mail"
â”‚   â”‚   â””â”€â”€ type: "hotel" | "firma" | "privat"
â”‚
â”œâ”€â”€ /pois               - POI-Favoriten
â”‚   â”œâ”€â”€ {poiId}
â”‚   â”‚   â”œâ”€â”€ name: "Bahnhof"
â”‚   â”‚   â”œâ”€â”€ address: "Bahnhofstr. 12"
â”‚   â”‚   â”œâ”€â”€ lat: 53.9547
â”‚   â”‚   â”œâ”€â”€ lon: 14.1783
â”‚   â”‚   â””â”€â”€ category: "Ã¶ffentlich" | "hotel" | "sonstiges"
â”‚
â”œâ”€â”€ /hotels             - Hotel-Daten
â”‚   â”œâ”€â”€ {hotelId}
â”‚   â”‚   â”œâ”€â”€ name: "Hotel Villa Monique"
â”‚   â”‚   â”œâ”€â”€ address: "Strandpromenade 1"
â”‚   â”‚   â””â”€â”€ rides: [...] (Import aus CSV)
â”‚
â”œâ”€â”€ /settings           - System-Einstellungen
â”‚   â”œâ”€â”€ /pricing
â”‚   â”‚   â”œâ”€â”€ basePrice: 3.50
â”‚   â”‚   â”œâ”€â”€ pricePerKm: 2.00
â”‚   â”‚   â”œâ”€â”€ nightSurcharge: 1.50
â”‚   â”‚   â”œâ”€â”€ holidaySurcharge: 5.00
â”‚   â”‚   â”œâ”€â”€ autoSurgeEnabled: false
â”‚   â”‚   â””â”€â”€ surgePerTaxi: 10
â”‚   â””â”€â”€ /system
â”‚       â””â”€â”€ bookingSystemOnline: true
â”‚
â””â”€â”€ /shifts             - Schichtplan
    â”œâ”€â”€ {shiftId}
    â”‚   â”œâ”€â”€ driverId: "driver-001"
    â”‚   â”œâ”€â”€ vehicleId: "taxi-001"
    â”‚   â”œâ”€â”€ start: 1704600000000
    â”‚   â””â”€â”€ end: 1704628800000
                    </div>
                    
                    <h3>ğŸ”§ Zugriff:</h3>
                    <div class="function-ref">
                        <strong>Lesen:</strong> db.ref('rides').once('value')<br>
                        <strong>Schreiben:</strong> db.ref('rides').push(data)<br>
                        <strong>Update:</strong> db.ref('rides/{id}').update(data)<br>
                        <strong>LÃ¶schen:</strong> db.ref('rides/{id}').remove()
                    </div>
                    
                    <h3>âš ï¸ Rules (Sicherheit):</h3>
                    <div class="warning-box">
                        <strong>Firebase Rules prÃ¼fen!</strong><br>
                        Stelle sicher dass nur berechtigte User Zugriff haben:<br>
                        - FahrgÃ¤ste: Nur eigene Fahrten lesen<br>
                        - Fahrer: Zugewiesene Fahrten + GPS schreiben<br>
                        - Admin: Alles
                    </div>
                `
            },
            
            'troubleshooting': {
                title: 'ğŸ› HÃ¤ufige Probleme & LÃ¶sungen',
                category: 'â“ Hilfe',
                tags: ['fehler', 'probleme', 'debug', 'lÃ¶sung'],
                lines: 'N/A',
                functions: [],
                content: `
                    <h2>ğŸ› HÃ¤ufige Probleme & LÃ¶sungen</h2>
                    
                    <h3>âŒ Express-Buchung: Karte lÃ¤dt nicht</h3>
                    <div class="error-box">
                        <strong>Symptom:</strong> Graue Box statt Karte<br><br>
                        <strong>Ursache:</strong> Leaflet CSS/JS nicht geladen<br><br>
                        <strong>LÃ¶sung:</strong><br>
                        1. Browser-Cache leeren (Strg+Shift+R)<br>
                        2. Console Ã¶ffnen (F12) â†’ Fehler suchen<br>
                        3. PrÃ¼fen: Leaflet CDN erreichbar?<br>
                        4. Notfall: index.html neu hochladen
                    </div>
                    
                    <h3>âŒ Karten-Klick funktioniert nicht</h3>
                    <div class="error-box">
                        <strong>Symptom:</strong> Klick macht nichts, keine Stecknadel<br><br>
                        <strong>Ursache:</strong> reverseGeocode Funktion fehlt (alte Version!)<br><br>
                        <strong>LÃ¶sung:</strong><br>
                        1. Version prÃ¼fen: v5.90.166+ verwenden!<br>
                        2. Console: "reverseGeocode is not defined"? â†’ Update nÃ¶tig!<br>
                        3. Neue index.html hochladen
                    </div>
                    
                    <h3>âŒ Nominatim "Too Many Requests"</h3>
                    <div class="error-box">
                        <strong>Symptom:</strong> Autocomplete funktioniert nicht mehr<br><br>
                        <strong>Ursache:</strong> Rate-Limit erreicht (1 Request/Sekunde!)<br><br>
                        <strong>LÃ¶sung:</strong><br>
                        1. 1-2 Minuten warten<br>
                        2. Weniger schnell tippen (Autocomplete wartet 300ms)<br>
                        3. POI-Favoriten nutzen (keine API-Calls!)
                    </div>
                    
                    <h3>âŒ OSRM Routing Ã¼ber Grenze (DEâ†’PL) klappt nicht</h3>
                    <div class="warning-box">
                        <strong>Symptom:</strong> Route wird nicht gezeichnet bei grenzÃ¼berschreitenden Fahrten<br><br>
                        <strong>Ursache:</strong> OSRM hat keine Routing-Daten Ã¼ber Grenze<br><br>
                        <strong>LÃ¶sung:</strong><br>
                        App nutzt automatisch Luftlinie als Fallback!<br>
                        Preis wird trotzdem berechnet (Luftlinie Ã— 1.3)
                    </div>
                    
                    <h3>âŒ Firebase: "Permission denied"</h3>
                    <div class="error-box">
                        <strong>Symptom:</strong> Daten kÃ¶nnen nicht gelesen/geschrieben werden<br><br>
                        <strong>Ursache:</strong> Firebase Rules zu strikt<br><br>
                        <strong>LÃ¶sung:</strong><br>
                        1. Firebase Console Ã¶ffnen<br>
                        2. Realtime Database â†’ Rules<br>
                        3. PrÃ¼fen: ".read" und ".write" korrekt?<br>
                        4. FÃ¼r Development: Rules auf "true" (NICHT fÃ¼r Production!)
                    </div>
                    
                    <h3>âŒ GPS-Tracking funktioniert nicht (Fahrer)</h3>
                    <div class="error-box">
                        <strong>Symptom:</strong> Position wird nicht aktualisiert<br><br>
                        <strong>LÃ¶sung:</strong><br>
                        1. Standort-Erlaubnis im Browser gegeben?<br>
                        2. GPS am Handy aktiviert?<br>
                        3. Browser-Tab muss aktiv bleiben!<br>
                        4. Console: "User denied Geolocation"?
                    </div>
                    
                    <h3>âŒ "isFirebaseReady is false"</h3>
                    <div class="error-box">
                        <strong>Symptom:</strong> Funktionen funktionieren nicht<br><br>
                        <strong>Ursache:</strong> Firebase nicht initialisiert<br><br>
                        <strong>LÃ¶sung:</strong><br>
                        1. Warten (5-10 Sekunden)<br>
                        2. Firebase Config in index.html prÃ¼fen<br>
                        3. Internet-Verbindung OK?<br>
                        4. Console: Firebase-Fehler?
                    </div>
                    
                    <h3>ğŸ”§ Debug-Tricks:</h3>
                    <div class="info-box">
                        <strong>Console Ã¶ffnen:</strong> F12 (Windows) oder Cmd+Option+I (Mac)<br>
                        <strong>Console-Log prÃ¼fen:</strong> Suche nach "âŒ" oder "Error"<br>
                        <strong>Network-Tab:</strong> PrÃ¼fe API-Calls (Nominatim, OSRM, Firebase)<br>
                        <strong>Cache leeren:</strong> Strg+Shift+R (Windows) oder Cmd+Shift+R (Mac)
                    </div>
                `
            }
        };
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // RENDER SIDEBAR
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        function renderSidebar(filter = '') {
            const sidebar = document.getElementById('sidebar');
            const categories = {};
            
            // Gruppiere nach Kategorie
            Object.keys(helpDatabase).forEach(key => {
                const item = helpDatabase[key];
                
                // Filter
                if (filter) {
                    const searchLower = filter.toLowerCase();
                    const matchTitle = item.title.toLowerCase().includes(searchLower);
                    const matchTags = item.tags.some(tag => tag.toLowerCase().includes(searchLower));
                    const matchFunctions = item.functions.some(fn => fn.toLowerCase().includes(searchLower));
                    
                    if (!matchTitle && !matchTags && !matchFunctions) {
                        return;
                    }
                }
                
                if (!categories[item.category]) {
                    categories[item.category] = [];
                }
                categories[item.category].push({ key, ...item });
            });
            
            // Render
            let html = '';
            Object.keys(categories).forEach(category => {
                html += `<div class="category">`;
                html += `<div class="category-title">${category}</div>`;
                
                categories[category].forEach(item => {
                    html += `
                        <div class="help-item" onclick="showContent('${item.key}')">
                            <div class="help-item-title">${item.title}</div>
                            <div class="help-item-meta">Zeile ${item.lines}</div>
                        </div>
                    `;
                });
                
                html += `</div>`;
            });
            
            if (html === '') {
                html = `
                    <div id="no-results">
                        <div class="emoji">ğŸ”</div>
                        <h3>Nichts gefunden</h3>
                        <p>Versuche andere Suchbegriffe!</p>
                    </div>
                `;
            }
            
            sidebar.innerHTML = html;
        }
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // SHOW CONTENT
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        function showContent(key) {
            const content = document.getElementById('content');
            const item = helpDatabase[key];
            
            if (!item) return;
            
            content.innerHTML = item.content;
            
            // Active State
            document.querySelectorAll('.help-item').forEach(el => el.classList.remove('active'));
            event.target.closest('.help-item').classList.add('active');
            
            // Scroll to top
            content.scrollTop = 0;
        }
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // SEARCH
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        const searchInput = document.getElementById('search-input');
        let searchTimeout;
        
        searchInput.addEventListener('input', (e) => {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                renderSidebar(e.target.value);
            }, 300);
        });
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // INIT
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        renderSidebar();
    </script>
</body>
</html>